<?php $this->css([$this->assetModule('css/block.css', 'news') => ['defer' => 'defer']]); ?>
<div class="news-block">
    <div class="news-item-block itemList clearfix">
        <?php if ($block['type'] == 'vertical') { ?>
            <div class="news-item-block-vertical clearfix">
                <?php foreach ($block['resources'] as $story) { ?>
                    <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                    <div class="vertical-story-single h-entry clearfix row" itemscope itemtype="https://schema.org/Article">
                        <?php if ($block['showimage'] && !empty($thumbUrl)) { ?>
                            <div class="col-lg-4 col-md-3 storyImage">
                                <a itemprop="url" title="<?php echo $this->escape($story['title']); ?>"
                                   href="<?php echo $this->escape($story['storyUrl']); ?>">
                                    <img itemprop="image" class="img-fluid u-photo"
                                         src="<?php echo $thumbUrl; ?>"
                                         alt="<?php echo $this->escape($story['title']); ?>"/>
                                </a>
                            </div>
                        <?php } ?>
                        <div class="<?php if ($block['showimage'] && !empty($thumbUrl)) { ?>col-lg-8 col-md-9<?php } else { ?>col-lg-12 col-md-12<?php } ?> p-item h-card">
                            <div class="vertical-story-single-title p-name" itemprop="name headline">
                                <h3 class="clearfix">
                                    <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                       title="<?php echo $this->escape($story['title']); ?>">
                                        <?php echo $this->escape($story['title']); ?>
                                    </a>
                                </h3>
                            </div>
                            <div class="vertical-story-single-information small">
                                <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                    <ul class="text-muted list-inline">
                                        <?php if ($block['showdate']) { ?>
                                            <li class="list-inline-item dt-published"><i
                                                        class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showhits']) { ?>
                                            <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                : <?php echo _number($this->escape($story['hits'])); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showauthor']) { ?>
                                            <?php foreach ($story['authors'] as $author) { ?>
                                                <li class="list-inline-item">
                                                    <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                    <a title="<?php echo $author['authorName']; ?>"
                                                       href="<?php echo $author['authorUrl']; ?>">
                                                        <?php echo $author['authorName']; ?>
                                                    </a>
                                                </li>
                                            <?php } ?>
                                        <?php } ?>
                                    </ul>
                                <?php } ?>
                            </div>
                            <div class="clearfix">
                                <?php if ($block['showdesc']) { ?>
                                    <div class="news-item-block-summary p-summary"><?php echo $story['text_summary']; ?></div>
                                <?php } ?>
                                <?php if ($block['showmore']) { ?>
                                    <div class="news-item-block-story-more">
                                        <a href="<?php echo $this->escape($story['storyUrl']); ?>"
                                           title="<?php echo $this->escape($story['title']); ?>"><?php echo _b('Read More'); ?></a>
                                    </div>
                                <?php } ?>
                            </div>
                        </div>
                    </div>
                    <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                <?php } ?>
            </div>
        <?php } elseif ($block['type'] == 'verticalwide') { ?>
            <div class="news-item-block-verticalwide clearfix">
                <?php foreach ($block['resources'] as $story) { ?>
                    <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                    <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                    <div class="media h-entry clearfix" itemscope itemtype="https://schema.org/Article">
                        <?php if ($block['showimage'] && !empty($thumbUrl)) { ?>
                            <div class="clearfix">
                                <a itemprop="url" class="u-url"
                                   href="<?php echo $this->escape($story['storyUrl']); ?>"
                                   title="<?php echo $this->escape($story['title']); ?>">
                                    <img itemprop="image" src="<?php echo $this->escape($mediumUrl); ?>"
                                         alt="<?php echo $this->escape($story['title']); ?>"
                                         class="media-object img-fluid u-photo"/>
                                </a>
                            </div>
                        <?php } ?>
                        <div class="media-body p-item h-card">
                            <h3 class="media-heading p-name itemSingleTitle" itemprop="name headline">
                                <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                   title="<?php echo $this->escape($story['title']); ?>">
                                    <?php echo $this->escape($story['title']); ?>
                                </a>
                            </h3>
                            <div class="clearfix">
                                <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                    <ul class="text-muted list-inline">
                                        <?php if ($block['showdate']) { ?>
                                            <li class="list-inline-item dt-published"><i
                                                        class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showhits']) { ?>
                                            <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                : <?php echo _number($this->escape($story['hits'])); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showauthor']) { ?>
                                            <?php foreach ($story['authors'] as $author) { ?>
                                                <li class="list-inline-item">
                                                    <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                    <a title="<?php echo $author['authorName']; ?>"
                                                       href="<?php echo $author['authorUrl']; ?>">
                                                        <?php echo $author['authorName']; ?>
                                                    </a>
                                                </li>
                                            <?php } ?>
                                        <?php } ?>
                                    </ul>
                                <?php } ?>
                                <?php if ($block['showdesc']) { ?>
                                    <div class="news-item-block-summary p-summary"><?php echo $story['text_summary']; ?></div>
                                <?php } ?>
                                <?php if ($block['showmore']) { ?>
                                    <div class="news-item-block-story-more">
                                        <a href="<?php echo $this->escape($story['storyUrl']); ?>"
                                           title="<?php echo $this->escape($story['title']); ?>"><?php echo _b('Read More'); ?></a>
                                    </div>
                                <?php } ?>
                            </div>
                        </div>
                        <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                    </div>
                <?php } ?>
            </div>
        <?php } elseif ($block['type'] == 'verticalcompressed') { ?>
            <div class="news-item-block-verticalcompressed list-group clearfix">
                <?php $i = 1; ?>
                <?php foreach ($block['resources'] as $story) { ?>
                    <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                    <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                    <?php if ($i == 1) { ?>
                        <div class="media h-entry clearfix" itemscope itemtype="https://schema.org/Article">
                            <div class="clearfix">
                                <a itemprop="url" class="u-url"
                                   href="<?php echo $this->escape($story['storyUrl']); ?>"
                                   title="<?php echo $this->escape($story['title']); ?>">
                                    <img itemprop="image" src="<?php echo $this->escape($mediumUrl); ?>"
                                         alt="<?php echo $this->escape($story['title']); ?>"
                                         class="media-object img-fluid u-photo"/>
                                </a>
                            </div>
                            <div class="media-body p-item h-card">
                                <h3 class="media-heading p-name itemSingleTitle" itemprop="name headline">
                                    <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                       title="<?php echo $this->escape($story['title']); ?>">
                                        <?php echo $this->escape($story['title']); ?>
                                    </a>
                                </h3>
                                <div class="clearfix">
                                    <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                        <ul class="text-muted list-inline">
                                            <?php if ($block['showdate']) { ?>
                                                <li class="list-inline-item dt-published"><i
                                                            class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                    : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                            <?php } ?>
                                            <?php if ($block['showhits']) { ?>
                                                <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                    : <?php echo _number($this->escape($story['hits'])); ?></li>
                                            <?php } ?>
                                            <?php if ($block['showauthor']) { ?>
                                                <?php foreach ($story['authors'] as $author) { ?>
                                                    <li class="list-inline-item">
                                                        <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                        <a title="<?php echo $author['authorName']; ?>"
                                                           href="<?php echo $author['authorUrl']; ?>">
                                                            <?php echo $author['authorName']; ?>
                                                        </a>
                                                    </li>
                                                <?php } ?>
                                            <?php } ?>
                                        </ul>
                                    <?php } ?>
                                    <?php if ($block['showdesc']) { ?>
                                        <div class="news-item-block-summary p-summary"><?php echo $story['text_summary']; ?></div>
                                    <?php } ?>
                                    <?php if ($block['showmore']) { ?>
                                        <div class="news-item-block-story-more">
                                            <a href="<?php echo $this->escape($story['storyUrl']); ?>"
                                               title="<?php echo $this->escape($story['title']); ?>"><?php echo _b('Read More'); ?></a>
                                        </div>
                                    <?php } ?>
                                </div>
                            </div>
                            <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                        </div>
                    <?php } else { ?>
                        <div class="h-entry list-group-item clearfix" itemscope itemtype="https://schema.org/Article">
                            <div class="p-item h-card">
                                <h4 class="p-name" itemprop="name headline">
                                    <i class="fas fa-angle-left"></i>
                                    <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                       title="<?php echo $this->escape($story['title']); ?>">
                                        <?php echo $this->escape($story['title']); ?>
                                    </a>
                                </h4>
                            </div>
                            <meta itemprop="image" content="<?php echo $this->escape($mediumUrl); ?>"/>
                            <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                        </div>
                    <?php } ?>
                    <?php $i++; ?>
                <?php } ?>
            </div>
        <?php } elseif ($block['type'] == 'horizontal') { ?>
            <div class="news-item-block-horizontal clearfix row">
                <?php foreach ($block['resources'] as $story) { ?>
                    <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                    <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                    <div class="h-entry col-md-3" itemscope itemtype="https://schema.org/Article">
                        <div class="news-item-block-horizontal-box clearfix">
                            <?php if ($block['showimage'] && !empty($thumbUrl)) { ?>
                                <a itemprop="url" class="u-url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                   title="<?php echo $this->escape($story['title']); ?>">
                                    <img itemprop="image" src="<?php echo $this->escape($mediumUrl); ?>"
                                         alt="<?php echo $this->escape($story['title']); ?>"
                                         class="media-object img-fluid u-photo"/>
                                </a>
                            <?php } ?>
                            <div class="p-item h-card">
                                <h3 class="p-name itemSingleTitle" itemprop="name headline">
                                    <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                       title="<?php echo $this->escape($story['title']); ?>">
                                        <?php echo $this->escape($story['title']); ?>
                                    </a>
                                </h3>

                                <div class="clearfix">
                                    <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                        <ul class="text-muted list-inline small">
                                            <?php if ($block['showdate']) { ?>
                                                <li class="list-inline-item dt-published"><i
                                                            class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                    : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                            <?php } ?>
                                            <?php if ($block['showhits']) { ?>
                                                <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                    : <?php echo _number($this->escape($story['hits'])); ?></li>
                                            <?php } ?>
                                            <?php if ($block['showauthor']) { ?>
                                                <?php foreach ($story['authors'] as $author) { ?>
                                                    <li class="list-inline-item">
                                                        <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                        <a title="<?php echo $author['authorName']; ?>"
                                                           href="<?php echo $author['authorUrl']; ?>">
                                                            <?php echo $author['authorName']; ?>
                                                        </a>
                                                    </li>
                                                <?php } ?>
                                            <?php } ?>
                                        </ul>
                                    <?php } ?>
                                    <?php if ($block['showdesc']) { ?>
                                        <div class="news-item-block-summary p-summary"><?php echo $story['text_summary']; ?></div>
                                    <?php } ?>
                                    <?php if ($block['showmore']) { ?>
                                        <div class="news-item-block-story-more">
                                            <a href="<?php echo $this->escape($story['storyUrl']); ?>"
                                               title="<?php echo $this->escape($story['title']); ?>"><?php echo _b('Read More'); ?></a>
                                        </div>
                                    <?php } ?>
                                </div>
                            </div>
                            <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                        </div>
                    </div>
                <?php } ?>
            </div>
        <?php } elseif ($block['type'] == 'list') { ?>
            <div class="news-item-block-list clearfix" itemscope itemtype="https://schema.org/ItemList">
                <ul class="list-unstyled">
                    <?php foreach ($block['resources'] as $story) { ?>
                        <li class="h-entry" itemscope itemtype="https://schema.org/Article" itemprop="itemListElement">
			                <span class="itemTitle p-name" itemprop="name">
				                <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                   title="<?php echo $this->escape($story['title']); ?>"><?php echo $this->escape($story['title']); ?></a>
			                </span>
                            <?php if ($block['showdate']) { ?>
                                <span class="itemPostDate dt-published">
				                    <?php echo _b('Time'); ?> : <?php echo $this->escape($story['time_publish_view']); ?>
			                    </span>
                            <?php } ?>
                            <?php if ($block['showhits']) { ?>
                                <span class="itemStats">
				                    <?php echo _b('Read'); ?> : <?php echo $this->escape($story['hits']); ?>
			                    </span>
                            <?php } ?>
                        </li>
                    <?php } ?>
                </ul>
            </div>
        <?php } elseif ($block['type'] == 'table') { ?>
            <div class="news-item-block-table clearfix">
                <table class="table table-striped table-bordered table-sm">
                    <tr char="head">
                        <th><?php echo _b('Title'); ?></th>
                        <?php if ($block['showdesc']) { ?>
                            <th><?php echo _b('Summary'); ?></th>
                        <?php } ?>
                        <?php if ($block['showdate']) { ?>
                            <th><?php echo _b('Time'); ?></th>
                        <?php } ?>
                        <?php if ($block['showhits']) { ?>
                            <th><?php echo _b('Read'); ?></th>
                        <?php } ?>
                    </tr>
                    <?php foreach ($block['resources'] as $story) { ?>
                        <tr class="odd h-entry" itemscope itemtype="https://schema.org/Article">
                            <td class="p-name" itemprop="name"><a href="<?php echo $this->escape($story['storyUrl']); ?>"
                                                                  title="<?php echo $this->escape($story['title']); ?>"><?php echo $this->escape(
                                        $story['title']
                                    ); ?></a>
                            </td>
                            <?php if ($block['showdesc']) { ?>
                                <td class="p-summary"><?php echo $this->escape($story['text_summary']); ?></td>
                            <?php } ?>
                            <?php if ($block['showdate']) { ?>
                                <td class="dt-published"><?php echo $this->escape($story['time_publish_view']); ?></td>
                            <?php } ?>
                            <?php if ($block['showhits']) { ?>
                                <td><?php echo $this->escape($story['hits']); ?></td>
                            <?php } ?>
                        </tr>
                    <?php } ?>
                </table>
            </div>
        <?php } elseif ($block['type'] == 'slide') { ?>
            <?php if ($block['blockEffect']) {
                $this->jQuery(
                    [
                        'extension/owl.carousel.min.js',
                        'extension/owl.carousel.min.css',
                    ]
                );
                $this->js($this->assetModule('js/owl.carousel.config.defer.js', 'news'), ['defer' => 'defer']);
            } ?>
            <div class="owl-carousel text-center clearfix">
                <?php foreach ($block['resources'] as $story) { ?>
                    <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                    <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                    <div class="item hover-captions hover-captions-slide col-sm-12 col-md-12" itemscope itemtype="https://schema.org/Article">
                        <div class="thumbnail">
                            <a itemprop="url" class="u-url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                               title="<?php echo $this->escape($story['title']); ?>">
                                <img itemprop="image" class="media-object img-fluid u-photo"
                                     src="<?php echo $this->escape($thumbUrl); ?>"
                                     alt="<?php echo $this->escape($story['title']); ?>">
                            </a>
                            <div class="caption">
                                <h3 itemprop="name headline">
                                    <a itemprop="url" class="u-url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                       title="<?php echo $this->escape($story['title']); ?>">
                                        <?php echo $this->escape($story['title']); ?>
                                    </a>
                                </h3>
                                <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                    <ul class="list-unstyled">
                                        <?php if ($block['showdate']) { ?>
                                            <li class="dt-published"><i
                                                        class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showhits']) { ?>
                                            <li><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                : <?php echo _number($this->escape($story['hits'])); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showauthor']) { ?>
                                            <?php foreach ($story['authors'] as $author) { ?>
                                                <li>
                                                    <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                    <a title="<?php echo $author['authorName']; ?>"
                                                       href="<?php echo $author['authorUrl']; ?>">
                                                        <?php echo $author['authorName']; ?>
                                                    </a>
                                                </li>
                                            <?php } ?>
                                        <?php } ?>
                                    </ul>
                                <?php } ?>
                                <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                            </div>
                        </div>
                    </div>
                <?php } ?>
            </div>
        <?php } elseif ($block['type'] == 'slidehover') { ?>
            <?php if ($block['blockEffect']) {
                $this->jQuery(
                    [
                        'extension/owl.carousel.min.js',
                        'extension/owl.carousel.min.css',
                    ]
                );
                $this->js($this->assetModule('js/owl.carousel.config.defer.js', 'news'), ['defer' => 'defer']);
                $this->js($this->assetModule('js/caption.hover.js', 'news'));
            } ?>
            <div class="owl-carousel text-center clearfix hover-captions-container">
                <?php foreach ($block['resources'] as $story) { ?>
                    <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                    <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                    <div class="item hover-captions hover-captions-slide col-sm-12 col-md-12" itemscope
                         itemtype="https://schema.org/Article">
                        <div class="hover-caption">
                            <ul class="list-unstyled">
                                <?php if ($block['showdate']) { ?>
                                    <li class="dt-published"><i
                                                class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                        : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                <?php } ?>
                                <?php if ($block['showhits']) { ?>
                                    <li><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                        : <?php echo _number($this->escape($story['hits'])); ?></li>
                                <?php } ?>
                                <?php if ($block['showauthor']) { ?>
                                    <?php foreach ($story['authors'] as $author) { ?>
                                        <li>
                                            <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                            <a title="<?php echo $author['authorName']; ?>"
                                               href="<?php echo $author['authorUrl']; ?>">
                                                <?php echo $author['authorName']; ?>
                                            </a>
                                        </li>
                                    <?php } ?>
                                <?php } ?>
                            </ul>
                            <p>
                                <a itemprop="url" class="u-url hover-caption-more"
                                   title="<?php echo $this->escape($story['title']); ?>"
                                   href="<?php echo $this->escape($story['storyUrl']); ?>">
                                    <?php echo _b('View'); ?>
                                </a>
                            </p>
                        </div>
                        <img itemprop="image" class="media-object img-fluid u-photo"
                             src="<?php echo $this->escape($thumbUrl); ?>"
                             alt="<?php echo $this->escape($story['title']); ?>">

                        <h3 itemprop="name headline"><?php echo $this->escape($story['title']); ?></h3>
                        <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                    </div>
                <?php } ?>
            </div>
        <?php } elseif ($block['type'] == 'carousel') { ?>
            <?php $carouselId = uniqid('carousel'); ?>
            <div class="news-item-block-carousel clearfix">
                <div id="<?php echo $carouselId; ?>" class="carousel slide" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <?php $i = 0; ?>
                        <?php foreach ($block['resources'] as $story) { ?>
                            <li data-target="#<?php echo $carouselId; ?>"
                                data-slide-to="<?php echo $i; ?>"<?php if ($i == 1) {
                                echo ' class="active"';
                            } ?>></li>
                            <?php $i++; ?>
                        <?php } ?>
                    </ol>
                    <div class="carousel-inner">
                        <?php $i = 1; ?>
                        <?php foreach ($block['resources'] as $story) { ?>
                            <?php $largeUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('large'); ?>
                            <div class="h-entry carousel-item<?php if ($i == 1) {
                                echo ' active';
                            } ?>" itemscope itemtype="https://schema.org/Article">
                                <a itemprop="url" class="u-url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                   title="<?php echo $this->escape($story['title']); ?>">
                                    <img itemprop="image" src="<?php echo $this->escape($largeUrl); ?>"
                                         alt="<?php echo $this->escape($story['title']); ?>"
                                         class="img-fluid u-photo d-block"/>
                                </a>

                                <div class="carousel-caption">
                                    <h4 class="p-name" itemprop="name headline">
                                        <a itemprop="url" class="u-url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                           title="<?php echo $this->escape($story['title']); ?>">
                                            <?php echo $this->escape($story['title']); ?>
                                        </a>
                                    </h4>
                                    <ul class="text-muted list-inline">
                                        <?php if ($block['showdate']) { ?>
                                            <li class="list-inline-item dt-published"><i
                                                        class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showhits']) { ?>
                                            <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                : <?php echo _number($this->escape($story['hits'])); ?></li>
                                        <?php } ?>
                                        <?php if ($block['showauthor']) { ?>
                                            <?php foreach ($story['authors'] as $author) { ?>
                                                <li class="list-inline-item">
                                                    <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                    <a title="<?php echo $author['authorName']; ?>"
                                                       href="<?php echo $author['authorUrl']; ?>">
                                                        <?php echo $author['authorName']; ?>
                                                    </a>
                                                </li>
                                            <?php } ?>
                                        <?php } ?>
                                    </ul>
                                    <?php if ($block['showdesc']) { ?>
                                        <div class="news-item-block-summary p-summary"><?php echo $story['text_summary']; ?></div>
                                    <?php } ?>
                                    <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                                </div>
                            </div>
                            <?php $i++; ?>
                        <?php } ?>
                        <a class="carousel-control-prev" href="#<?php echo $carouselId; ?>" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#<?php echo $carouselId; ?>" role="button" data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
        <?php } elseif ($block['type'] == 'image') { ?>
            <div class="news-item-block-image clearfix">
                <div class="row">
                    <?php if ($block['number'] == 1) {
                        $class = 'col-md-12 col-sm-12 col-12';
                    } else {
                        $class = 'col-md-6 col-sm-6 col-12';
                    } ?>
                    <?php foreach ($block['resources'] as $story) { ?>
                        <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                        <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                        <div class="h-entry clearfix <?php echo $class; ?>" itemscope itemtype="https://schema.org/Article">
                            <a itemprop="url" class="u-url"
                               href="<?php echo $this->escape($story['storyUrl']); ?>"
                               title="<?php echo $this->escape($story['title']); ?>">
                                <img itemprop="image" src="<?php echo $this->escape($mediumUrl); ?>"
                                     alt="<?php echo $this->escape($story['title']); ?>"
                                     class="img-fluid u-photo"/>
                            </a>
                            <?php if ($block['showdesc']) { ?>
                                <div class="news-item-block-image-text">
                                    <h2>
                                        <a itemprop="url" class="u-url"
                                           href="<?php echo $this->escape($story['storyUrl']); ?>"
                                           title="<?php echo $this->escape($story['title']); ?>">
                                            <?php echo $this->escape($story['title']); ?>
                                        </a>
                                    </h2>
                                    <div class="news-item-block-summary p-summary"><?php echo $story['text_summary']; ?></div>
                                </div>
                            <?php } ?>
                            <meta itemprop="datePublished" content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                            <meta itemprop="name" content="<?php echo $this->escape($story['title']); ?>"/>
                            <meta itemprop="headline" content="<?php echo $this->escape($story['title']); ?>"/>
                        </div>
                    <?php } ?>
                </div>
            </div>
        <?php } elseif ($block['type'] == 'magazine') { ?>
            <div class="news-item-block-magazine clearfix row">
                <?php $firstStory = array_shift($block['resources']); ?>
                <div class="col-md-3 col-sm-5 col-12">
                    <div class="news-item-block-magazine-main">
                        <div class="h-entry clearfix" itemscope itemtype="https://schema.org/Article">
                            <div class="p-item h-card">
                                <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($firstStory['main_image'])->setConfigModule('news')->thumb(
                                    'medium'
                                ); ?>
                                <?php if ($block['showimage'] && !empty($mediumUrl)) { ?>
                                    <a itemprop="url" class="u-url"
                                       href="<?php echo $this->escape($firstStory['storyUrl']); ?>"
                                       title="<?php echo $this->escape($firstStory['title']); ?>">
                                        <img itemprop="image" src="<?php echo $this->escape($mediumUrl); ?>"
                                             alt="<?php echo $this->escape($firstStory['title']); ?>"
                                             class="media-object img-fluid u-photo"/>
                                    </a>
                                <?php } ?>
                                <h3 class="p-name itemSingleTitle" itemprop="name headline">
                                    <a itemprop="url" href="<?php echo $this->escape($firstStory['storyUrl']); ?>"
                                       title="<?php echo $this->escape($firstStory['title']); ?>">
                                        <?php echo $this->escape($firstStory['title']); ?>
                                    </a>
                                </h3>
                                <div class="clearfix">
                                    <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                        <ul class="text-muted list-inline">
                                            <?php if ($block['showdate']) { ?>
                                                <li class="list-inline-item dt-published"><i
                                                            class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                    : <?php echo $this->escape($firstStory['time_publish_view']); ?></li>
                                            <?php } ?>
                                            <?php if ($block['showhits']) { ?>
                                                <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                    : <?php echo _number($this->escape($firstStory['hits'])); ?></li>
                                            <?php } ?>
                                            <?php if ($block['showauthor']) { ?>
                                                <?php foreach ($firstStory['authors'] as $author) { ?>
                                                    <li class="list-inline-item">
                                                        <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                        <a title="<?php echo $author['authorName']; ?>"
                                                           href="<?php echo $author['authorUrl']; ?>">
                                                            <?php echo $author['authorName']; ?>
                                                        </a>
                                                    </li>
                                                <?php } ?>
                                            <?php } ?>
                                        </ul>
                                    <?php } ?>
                                </div>
                                <?php if ($block['showdesc']) { ?>
                                    <div class="news-item-block-summary p-summary"><?php echo $firstStory['text_summary']; ?></div>
                                <?php } ?>
                                <?php if ($block['showmore']) { ?>
                                    <div class="news-item-block-story-more">
                                        <a href="<?php echo $this->escape($story['storyUrl']); ?>"
                                           title="<?php echo $this->escape($story['title']); ?>"><?php echo _b('Read More'); ?></a>
                                    </div>
                                <?php } ?>
                                <meta itemprop="datePublished"
                                      content="<?php echo $this->escape(date("Y-m-d H:i:s", $firstStory['time_publish'])); ?>"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-9 col-sm-7 col-12">
                    <div class="row">
                        <?php foreach ($block['resources'] as $story) { ?>
                            <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                            <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                            <div class="col-md-6 col-sm-6 col-12">
                                <div class="news-item-block-magazine-sub">
                                    <div class="h-entry clearfix row" itemscope itemtype="https://schema.org/Article">
                                        <div class="col-md-4 col-sm-4 col-5">
                                            <?php if ($block['showimage'] && !empty($thumbUrl)) { ?>
                                                <a itemprop="url" class="u-url"
                                                   href="<?php echo $this->escape($story['storyUrl']); ?>"
                                                   title="<?php echo $this->escape($story['title']); ?>">
                                                    <img itemprop="image" src="<?php echo $this->escape($thumbUrl); ?>"
                                                         alt="<?php echo $this->escape($story['title']); ?>"
                                                         class="media-object img-fluid u-photo"/>
                                                </a>
                                            <?php } ?>
                                        </div>
                                        <div class="col-md-8 col-sm-8 col-7">
                                            <div class="p-item h-card">
                                                <h4 class="p-name itemSingleTitle" itemprop="name headline">
                                                    <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                                       title="<?php echo $this->escape($story['title']); ?>">
                                                        <?php echo $this->escape($story['title']); ?>
                                                    </a>
                                                </h4>
                                                <div class="clearfix">
                                                    <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                                        <ul class="text-muted list-inline">
                                                            <?php if ($block['showdate']) { ?>
                                                                <li class="list-inline-item dt-published"><i
                                                                            class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                                    : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                                            <?php } ?>
                                                            <?php if ($block['showhits']) { ?>
                                                                <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                                    : <?php echo _number($this->escape($story['hits'])); ?></li>
                                                            <?php } ?>
                                                            <?php if ($block['showauthor']) { ?>
                                                                <?php foreach ($story['authors'] as $author) { ?>
                                                                    <li class="list-inline-item">
                                                                        <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                                        <a title="<?php echo $author['authorName']; ?>"
                                                                           href="<?php echo $author['authorUrl']; ?>">
                                                                            <?php echo $author['authorName']; ?>
                                                                        </a>
                                                                    </li>
                                                                <?php } ?>
                                                            <?php } ?>
                                                        </ul>
                                                    <?php } ?>
                                                </div>
                                            </div>
                                            <?php if ($block['showdesc']) { ?>
                                                <div class="news-item-block-summary p-summary"><?php echo $story['text_summary']; ?></div>
                                            <?php } ?>
                                            <meta itemprop="datePublished"
                                                  content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <?php } ?>
                    </div>
                </div>
            </div>
        <?php } elseif ($block['type'] == 'magazinewide') { ?>
            <div class="news-item-block-magazine-wide clearfix row">
                <?php $firstStory = array_shift($block['resources']); ?>
                <div class="col-md-12 col-sm-12 col-12">
                    <div class="news-item-block-magazine-main">
                        <div class="h-entry clearfix" itemscope itemtype="https://schema.org/Article">
                            <div class="p-item h-card row">
                                <div class="col-md-8 col-sm-7 col-12">
                                    <h3 class="p-name itemSingleTitle" itemprop="name headline">
                                        <a itemprop="url" href="<?php echo $this->escape($firstStory['storyUrl']); ?>"
                                           title="<?php echo $this->escape($firstStory['title']); ?>">
                                            <?php echo $this->escape($firstStory['title']); ?>
                                        </a>
                                    </h3>
                                    <div class="clearfix">
                                        <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                            <ul class="text-muted list-inline">
                                                <?php if ($block['showdate']) { ?>
                                                    <li class="list-inline-item dt-published"><i
                                                                class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                        : <?php echo $this->escape($firstStory['time_publish_view']); ?></li>
                                                <?php } ?>
                                                <?php if ($block['showhits']) { ?>
                                                    <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                        : <?php echo _number($this->escape($firstStory['hits'])); ?></li>
                                                <?php } ?>
                                                <?php if ($block['showauthor']) { ?>
                                                    <?php foreach ($firstStory['authors'] as $author) { ?>
                                                        <li class="list-inline-item">
                                                            <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                            <a title="<?php echo $author['authorName']; ?>"
                                                               href="<?php echo $author['authorUrl']; ?>">
                                                                <?php echo $author['authorName']; ?>
                                                            </a>
                                                        </li>
                                                    <?php } ?>
                                                <?php } ?>
                                            </ul>
                                        <?php } ?>
                                    </div>
                                    <?php if ($block['showdesc']) { ?>
                                        <div class="news-item-block-summary p-summary"><?php echo $firstStory['text_summary']; ?></div>
                                    <?php } ?>
                                    <?php if ($block['showmore']) { ?>
                                        <div class="news-item-block-story-more">
                                            <a href="<?php echo $this->escape($story['storyUrl']); ?>"
                                               title="<?php echo $this->escape($story['title']); ?>"><?php echo _b('Read More'); ?></a>
                                        </div>
                                    <?php } ?>
                                    <meta itemprop="datePublished"
                                          content="<?php echo $this->escape(date("Y-m-d H:i:s", $firstStory['time_publish'])); ?>"/>
                                </div>
                                <div class="col-md-4 col-sm-5 col-12">
                                    <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($firstStory['main_image'])->setConfigModule('news')->thumb(
                                        'medium'
                                    ); ?>
                                    <?php if ($block['showimage'] && !empty($mediumUrl)) { ?>
                                        <a itemprop="url" class="u-url"
                                           href="<?php echo $this->escape($firstStory['storyUrl']); ?>"
                                           title="<?php echo $this->escape($firstStory['title']); ?>">
                                            <img itemprop="image" src="<?php echo $this->escape($mediumUrl); ?>"
                                                 alt="<?php echo $this->escape($firstStory['title']); ?>"
                                                 class="media-object img-fluid u-photo"/>
                                        </a>
                                    <?php } ?>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 col-sm-12 col-12">
                    <div class="row">
                        <?php foreach ($block['resources'] as $story) { ?>
                            <?php $thumbUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('thumbnail'); ?>
                            <?php $mediumUrl = Pi::api('doc', 'media')->getSingleLinkUrl($story['main_image'])->setConfigModule('news')->thumb('medium'); ?>
                            <div class="col-md-6 col-sm-6 col-12">
                                <div class="news-item-block-magazine-sub">
                                    <div class="h-entry clearfix row" itemscope itemtype="https://schema.org/Article">
                                        <div class="col-md-4 col-sm-4 col-5">
                                            <?php if ($block['showimage'] && !empty($thumbUrl)) { ?>
                                                <a itemprop="url" class="u-url"
                                                   href="<?php echo $this->escape($story['storyUrl']); ?>"
                                                   title="<?php echo $this->escape($story['title']); ?>">
                                                    <img itemprop="image" src="<?php echo $this->escape($thumbUrl); ?>"
                                                         alt="<?php echo $this->escape($story['title']); ?>"
                                                         class="media-object img-fluid u-photo"/>
                                                </a>
                                            <?php } ?>
                                        </div>
                                        <div class="col-md-8 col-sm-8 col-7">
                                            <div class="p-item h-card">
                                                <h4 class="p-name itemSingleTitle" itemprop="name headline">
                                                    <a itemprop="url" href="<?php echo $this->escape($story['storyUrl']); ?>"
                                                       title="<?php echo $this->escape($story['title']); ?>">
                                                        <?php echo $this->escape($story['title']); ?>
                                                    </a>
                                                </h4>
                                                <div class="clearfix">
                                                    <?php if ($block['showdate'] || $block['showhits'] || $block['showauthor']) { ?>
                                                        <ul class="text-muted list-inline">
                                                            <?php if ($block['showdate']) { ?>
                                                                <li class="list-inline-item dt-published"><i
                                                                            class="fas fa-calendar-alt"></i> <?php echo _b('Time'); ?>
                                                                    : <?php echo $this->escape($story['time_publish_view']); ?></li>
                                                            <?php } ?>
                                                            <?php if ($block['showhits']) { ?>
                                                                <li class="list-inline-item"><i class="far fa-eye"></i> <?php echo _b('Read'); ?>
                                                                    : <?php echo _number($this->escape($story['hits'])); ?></li>
                                                            <?php } ?>
                                                            <?php if ($block['showauthor']) { ?>
                                                                <?php foreach ($story['authors'] as $author) { ?>
                                                                    <li class="list-inline-item">
                                                                        <i class="fas fa-user"></i> <?php echo $author['authorRole']; ?> :
                                                                        <a title="<?php echo $author['authorName']; ?>"
                                                                           href="<?php echo $author['authorUrl']; ?>">
                                                                            <?php echo $author['authorName']; ?>
                                                                        </a>
                                                                    </li>
                                                                <?php } ?>
                                                            <?php } ?>
                                                        </ul>
                                                    <?php } ?>
                                                </div>
                                            </div>
                                            <meta itemprop="datePublished"
                                                  content="<?php echo $this->escape(date("Y-m-d H:i:s", $story['time_publish'])); ?>"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <?php } ?>
                    </div>
                </div>
            </div>
        <?php } ?>
        <?php if ($block['showblockmore']) { ?>
            <div class="news-block-more clearfix">
                <a class="float-right" title="<?php echo _b('More stories'); ?>"
                   href="<?php echo $block['linkblockmore']; ?>"><?php echo _b('More stories'); ?></a>
            </div>
        <?php } ?>
    </div>
</div>